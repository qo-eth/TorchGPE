
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Potentials &#8212; TorchGPE 1.0.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css?v=d110ab36" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=8d563738"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user_guide/fundamentals.potentials';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Callbacks" href="fundamentals.callbacks.html" />
    <link rel="prev" title="The Gas class" href="fundamentals.gas_class.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">TorchGPE package documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-external" href="https://www.quantumoptics.ethz.ch">
    Quantum Optics group
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API reference
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/torchgpe" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-box fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/qo-eth/TorchGPE" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-external" href="https://www.quantumoptics.ethz.ch">
    Quantum Optics group
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API reference
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/torchgpe" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-box fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/qo-eth/TorchGPE" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
</form></div>
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="about.html">About the package</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">TorchGPE quickstart</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Usage</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="fundamentals.html">Basic usage</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="fundamentals.gas_class.html">The Gas class</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Potentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="fundamentals.callbacks.html">Callbacks</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="extending_torchgpe.html">Advanced usage</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="extending_torchgpe.configuration_files.html">Using configuration files</a></li>
<li class="toctree-l2"><a class="reference internal" href="extending_torchgpe.custom_potentials.html">Defining custom potentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="extending_torchgpe.custom_callbacks.html">Defining custom callbacks</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">User Guide</a></li>
    
    
    <li class="breadcrumb-item"><a href="fundamentals.html" class="nav-link">Basic usage</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Potentials</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="potentials">
<h1>Potentials<a class="headerlink" href="#potentials" title="Link to this heading">#</a></h1>
<p>Potentials describe the experimental apparatus to be simulated. The common behavior of any potential is defined in the <a class="reference internal" href="../api/potentials.html#torchgpe.utils.potentials.Potential" title="torchgpe.utils.potentials.Potential"><code class="xref py py-class docutils literal notranslate"><span class="pre">Potential</span></code></a> class, from which both <a class="reference internal" href="../api/potentials.html#torchgpe.utils.potentials.LinearPotential" title="torchgpe.utils.potentials.LinearPotential"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinearPotential</span></code></a> and <a class="reference internal" href="../api/potentials.html#torchgpe.utils.potentials.NonLinearPotential" title="torchgpe.utils.potentials.NonLinearPotential"><code class="xref py py-class docutils literal notranslate"><span class="pre">NonLinearPotential</span></code></a> inherit. Distinguishing between linear and non-linear potentials allows to separate the computation of the linear and non-linear parts of the Hamiltonian, which are computed separately in the propagation. This allows to optimize the computation of the linear part, which does not change during the evolution.</p>
<p>Linear potentials must implement the <a class="reference internal" href="../stubs/torchgpe.utils.potentials.LinearPotential.get_potential.html#torchgpe.utils.potentials.LinearPotential.get_potential" title="torchgpe.utils.potentials.LinearPotential.get_potential"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_potential()</span></code></a> method, which takes the coordinates of the grid (<a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.X.html#torchgpe.bec2D.gas.Gas.X" title="torchgpe.bec2D.gas.Gas.X"><code class="xref py py-attr docutils literal notranslate"><span class="pre">X</span></code></a> and <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.Y.html#torchgpe.bec2D.gas.Gas.Y" title="torchgpe.bec2D.gas.Gas.Y"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Y</span></code></a> for a 2D grid) and an optional parameter <code class="xref py py-obj docutils literal notranslate"><span class="pre">time</span></code>, and returns the linear potential evaluated on the grid. For time independent potentials, the function is called with <code class="docutils literal notranslate"><span class="pre">time=None</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">time</span></code> should be ignored by the potential.</p>
<p>Similarly, non-linear potentials implement the <a class="reference internal" href="../stubs/torchgpe.utils.potentials.NonLinearPotential.potential_function.html#torchgpe.utils.potentials.NonLinearPotential.potential_function" title="torchgpe.utils.potentials.NonLinearPotential.potential_function"><code class="xref py py-meth docutils literal notranslate"><span class="pre">potential_function()</span></code></a> function. This takes the same parameters as <a class="reference internal" href="../stubs/torchgpe.utils.potentials.LinearPotential.get_potential.html#torchgpe.utils.potentials.LinearPotential.get_potential" title="torchgpe.utils.potentials.LinearPotential.get_potential"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_potential()</span></code></a>, with the addition of the wave function <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.psi.html#torchgpe.bec2D.gas.Gas.psi" title="torchgpe.bec2D.gas.Gas.psi"><code class="xref py py-attr docutils literal notranslate"><span class="pre">psi</span></code></a>. The function returns the non-linear potential evaluated on the grid.</p>
<p>Both kinds of potentials can be provided with additional parameters when instantiated. In addition, TorchGPE will provide them with an instance of the Gas class when the simulation starts, via the method <a class="reference internal" href="../stubs/torchgpe.utils.potentials.Potential.set_gas.html#torchgpe.utils.potentials.Potential.set_gas" title="torchgpe.utils.potentials.Potential.set_gas"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_gas()</span></code></a>. This allows the potential to access the gas parameters, such as the number of particles, the mass, etc. After the gas is set and before the propagation is run, the function <a class="reference internal" href="../stubs/torchgpe.utils.potentials.Potential.on_propagation_begin.html#torchgpe.utils.potentials.Potential.on_propagation_begin" title="torchgpe.utils.potentials.Potential.on_propagation_begin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">on_propagation_begin()</span></code></a> is called on the potential. This allows the potential to perform any further initialization using the properties contained in the gas.</p>
<p>Note that some potentials support time dependent parameters. These can be provided by passing them a function of time instead of a constant value. For example, while <code class="docutils literal notranslate"><span class="pre">Trap(omegax=100,</span> <span class="pre">omegay=100)</span></code> creates a trap with constant frequencies,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">Trap</span><span class="p">(</span><span class="n">omegax</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="mi">100</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">omegay</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="mi">100</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
</pre></div>
</div>
<p>creates a trap whose frequencies oscillate in time.</p>
<p>Some common time dependencies are implemented already for convenience: <a class="reference internal" href="../stubs/torchgpe.utils.potentials.linear_ramp.html#torchgpe.utils.potentials.linear_ramp" title="torchgpe.utils.potentials.linear_ramp"><code class="xref py py-meth docutils literal notranslate"><span class="pre">linear_ramp()</span></code></a>, <a class="reference internal" href="../stubs/torchgpe.utils.potentials.s_ramp.html#torchgpe.utils.potentials.s_ramp" title="torchgpe.utils.potentials.s_ramp"><code class="xref py py-meth docutils literal notranslate"><span class="pre">s_ramp()</span></code></a> and <a class="reference internal" href="../stubs/torchgpe.utils.potentials.quench.html#torchgpe.utils.potentials.quench" title="torchgpe.utils.potentials.quench"><code class="xref py py-meth docutils literal notranslate"><span class="pre">quench()</span></code></a> implement a linear ramp, a smooth one, and a quench experiment, respectively.</p>
<p>For example, if the potential <code class="xref py py-obj docutils literal notranslate"><span class="pre">ExamplePotential</span></code> supports a time dependent parameter <code class="xref py py-attr docutils literal notranslate"><span class="pre">strength</span></code>, the sweep of the parameter from <code class="docutils literal notranslate"><span class="pre">0</span></code> to <code class="docutils literal notranslate"><span class="pre">1</span></code> in <span class="math notranslate nohighlight">\(1\, ms\)</span> can be achieved with</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">potential</span> <span class="o">=</span> <span class="n">ExamplePotential</span><span class="p">(</span><span class="n">strength</span><span class="o">=</span><span class="n">linear_ramp</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">))</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If a constant value is passed to a time dependent parameter, it will be converted to a function that returns the same value for any time. In other words, the following two lines are equivalent</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">potential</span> <span class="o">=</span> <span class="n">ExamplePotential</span><span class="p">(</span><span class="n">strength</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">2</span><span class="n">potential</span> <span class="o">=</span> <span class="n">ExamplePotential</span><span class="p">(</span><span class="n">strength</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As TorchGPE works with adimensionalized units, the potentials should be implemented in such a way that the returned values are also adimensional.</p>
</div>
<section id="implemented-potentials">
<h2>Implemented potentials<a class="headerlink" href="#implemented-potentials" title="Link to this heading">#</a></h2>
<p>Here, we want to provide an overview of the implemented potentials. Please, refer to the API documentation and the advanced usage section for more details on the structure of the potentials and how to implement custom ones.</p>
<section id="linear-potentials">
<h3>Linear potentials<a class="headerlink" href="#linear-potentials" title="Link to this heading">#</a></h3>
<section id="zero">
<h4>Zero<a class="headerlink" href="#zero" title="Link to this heading">#</a></h4>
<p>The <a class="reference internal" href="../api/potentials.html#torchgpe.bec2D.potentials.Zero" title="torchgpe.bec2D.potentials.Zero"><code class="xref py py-class docutils literal notranslate"><span class="pre">Zero</span></code></a> potential is the default one. It is a linear potential that returns zero for any position and time. Because of this, it is not necessary to provide any parameter to instantiate it.</p>
</section>
<section id="trap">
<h4>Trap<a class="headerlink" href="#trap" title="Link to this heading">#</a></h4>
<p><a class="reference internal" href="../api/potentials.html#torchgpe.bec2D.potentials.Trap" title="torchgpe.bec2D.potentials.Trap"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trap</span></code></a> implements an harmonic trap potential. When initialized, it takes the parameters <code class="xref py py-attr docutils literal notranslate"><span class="pre">omegax</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">omegay</span></code>, which are the frequencies in <span class="math notranslate nohighlight">\(Hz\)</span> of the trap in the x and y directions, respectively. Note that both the frequencies are time dependent parameters, and hence they can be both constants or functions of time.</p>
<p>The returned potential is</p>
<div class="math notranslate nohighlight">
\[\text{Trap}(x, y, t) = 2 \pi^2 \left( \frac{\omega_x\left(t\right)^2}{\omega_l^2} x^2 + \frac{\omega_y\left(t\right)^2}{\omega_l^2} y^2 \right),\]</div>
<p>where <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> are the adimensionalized coordinates, <span class="math notranslate nohighlight">\(\omega_x\)</span> and <span class="math notranslate nohighlight">\(\omega_y\)</span> are the provided frequencies (in SI units) and <span class="math notranslate nohighlight">\(\omega_l\)</span> is the adimensionalisation pulse.</p>
</section>
<section id="squarebox">
<h4>SquareBox<a class="headerlink" href="#squarebox" title="Link to this heading">#</a></h4>
<p><a class="reference internal" href="../api/potentials.html#torchgpe.bec2D.potentials.SquareBox" title="torchgpe.bec2D.potentials.SquareBox"><code class="xref py py-class docutils literal notranslate"><span class="pre">SquareBox</span></code></a> implements a square box potential centered at the origin. When initialized, it takes the parameters <code class="xref py py-attr docutils literal notranslate"><span class="pre">V</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">D</span></code>, which are the depth and size of the box, respectively. Similarly to the <a class="reference internal" href="../api/potentials.html#torchgpe.bec2D.potentials.Trap" title="torchgpe.bec2D.potentials.Trap"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trap</span></code></a> case, both the parameters are passed in SI units, and adimensionalized by the potential itself.</p>
<p>The returned potential is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\text{SquareBox}(x, y) = \begin{cases}
    {V}/{\hbar \omega_l} &amp; \text{if } \left|x\right| &lt; {D}/{2l} \text{ and } \left|y\right| &lt; {D}/{2l} \\
    0 &amp; \text{otherwise}
\end{cases},\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(l\)</span> is the adimensionalisation length.</p>
</section>
<section id="roundbox">
<h4>RoundBox<a class="headerlink" href="#roundbox" title="Link to this heading">#</a></h4>
<p><a class="reference internal" href="../api/potentials.html#torchgpe.bec2D.potentials.RoundBox" title="torchgpe.bec2D.potentials.RoundBox"><code class="xref py py-class docutils literal notranslate"><span class="pre">RoundBox</span></code></a> implements a round box potential centered at the origin. When initialized, it takes the parameters <code class="xref py py-attr docutils literal notranslate"><span class="pre">V</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">D</span></code>, which are the depth and diameter of the box, respectively. Similarly to the <a class="reference internal" href="../api/potentials.html#torchgpe.bec2D.potentials.Trap" title="torchgpe.bec2D.potentials.Trap"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trap</span></code></a> case, both the parameters are passed in SI units, and adimensionalized by the potential itself.</p>
<p>The returned potential is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\text{RoundBox}(x, y) = \begin{cases}
    {V}/{\hbar \omega_l} &amp; \text{if } \sqrt{x^2 + y^2} &lt; {D}/{2l} \\
    0 &amp; \text{otherwise}
\end{cases},\end{split}\]</div>
</section>
<section id="lattice">
<h4>Lattice<a class="headerlink" href="#lattice" title="Link to this heading">#</a></h4>
<p><a class="reference internal" href="../api/potentials.html#torchgpe.bec2D.potentials.Lattice" title="torchgpe.bec2D.potentials.Lattice"><code class="xref py py-class docutils literal notranslate"><span class="pre">Lattice</span></code></a> implements the lattice potential produced by a gaussian beam. When initialized, it takes the parameters:</p>
<ul class="simple">
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">V0</span></code> (the lattice depth),</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">lam</span></code> (the wave length),</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">theta</span></code> (the angle with respect to the horizontal),</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">phi</span></code> (the phase of the beam),</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">w0</span></code> (the waist of the gaussian beam).</p></li>
</ul>
<p>Note that <code class="xref py py-attr docutils literal notranslate"><span class="pre">V0</span></code> should be provided in units of the recoil energy <span class="math notranslate nohighlight">\(E_r = \hbar^2 k^2 / 2m\)</span>, where <span class="math notranslate nohighlight">\(k = 2 \pi / \lambda\)</span> is the wave number of the lattice. The other parameters are passed in SI units, and adimensionalized by the potential itself.
Both <code class="xref py py-attr docutils literal notranslate"><span class="pre">V0</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">phi</span></code> are time dependent parameters, and hence they can be both constants or functions of time. By default, the waist <code class="xref py py-attr docutils literal notranslate"><span class="pre">w0</span></code> is set to infinity, which corresponds to a plane wave.</p>
<p>When the waist is set to be different than infinity, the returned potential also accounts for the wavefront curvature and the Gouy phase.</p>
<a class="reference internal image-reference" href="../_images/fundamentals_lattice_angles.svg"><img alt="Lattice angles scheme" class="align-center" src="../_images/fundamentals_lattice_angles.svg" style="width: 450px;" />
</a>
<p>In its simplest form (that is, when <code class="docutils literal notranslate"><span class="pre">theta</span> <span class="pre">=</span> <span class="pre">0</span></code> and <code class="docutils literal notranslate"><span class="pre">w0</span> <span class="pre">=</span> <span class="pre">np.Inf</span></code> ), the returned potential is:</p>
<div class="math notranslate nohighlight">
\[\text{Lattice}(x, y, t) = \frac{V_0 \cdot E_{rec}}{\hbar \omega_l} \cos\left(\frac{2 \pi l}{\lambda} x+\phi\right)^2\]</div>
<p>where <span class="math notranslate nohighlight">\(E_{rec} = \hbar^2 k^2 / 2m\)</span> is the recoil energy, <span class="math notranslate nohighlight">\(l\)</span> is the adimensionalisation length and <span class="math notranslate nohighlight">\(\lambda\)</span> and <span class="math notranslate nohighlight">\(\phi\)</span> the parameters <code class="xref py py-attr docutils literal notranslate"><span class="pre">lam</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">phi</span></code> respectively.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Gaussian_beam">Wikipedia page on the gaussan beam</a> provides details on how is the potential changed when the waist is finite.</p>
</div>
</section>
</section>
<section id="non-linear-potentials">
<h3>Non-linear potentials<a class="headerlink" href="#non-linear-potentials" title="Link to this heading">#</a></h3>
<section id="contact">
<span id="fundamentals-potentials-contact"></span><h4>Contact<a class="headerlink" href="#contact" title="Link to this heading">#</a></h4>
<p><a class="reference internal" href="../api/potentials.html#torchgpe.bec2D.potentials.Contact" title="torchgpe.bec2D.potentials.Contact"><code class="xref py py-class docutils literal notranslate"><span class="pre">Contact</span></code></a> implements the contact interaction potential. When initialized, it takes the parameters <code class="xref py py-attr docutils literal notranslate"><span class="pre">a_s</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">a_orth</span></code>, which are the scattering length and a renormalization factor for the transverse direction, respectively. The scattering length <code class="xref py py-attr docutils literal notranslate"><span class="pre">a_s</span></code> is expressed in units of the Bohr radius <span class="math notranslate nohighlight">\(a_B\)</span>.</p>
<p>The returned potential is</p>
<div class="math notranslate nohighlight">
\[\text{Contact}(x, y, \psi, t) = \sqrt{8\pi}N \frac{a_s a_B}{a_\perp} \left\|\psi\right\|^2,\]</div>
<p>where <span class="math notranslate nohighlight">\(N\)</span> is the number of particles and <span class="math notranslate nohighlight">\(a_\perp\)</span> is the renormalization factor <code class="xref py py-attr docutils literal notranslate"><span class="pre">a_orth</span></code>.</p>
<p>Note that the interaction strength for a 3D system, which reads <span class="math notranslate nohighlight">\(g_{3D} = 4 \pi \hbar^2 a_s a_B / m\)</span>, is now divided by a factor <span class="math notranslate nohighlight">\(\sqrt{2\pi}a_\perp\)</span> to account for the missing third dimension. The orthogonal scattering length <span class="math notranslate nohighlight">\(a_\perp\)</span> satisfies the equation <span class="math notranslate nohighlight">\(a_\perp^2 = a_{ho}^2 \sqrt{1+2 a_s N \left\|\psi\right\|^2}\)</span>, where <span class="math notranslate nohighlight">\(a_{ho}\)</span> is the length scale of the harmonic oscillator generating the confinment in the <span class="math notranslate nohighlight">\(z\)</span> direction. For weakly interacting systems, <span class="math notranslate nohighlight">\(a_\perp^2 \approx a_{ho}\)</span>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Reference for the dimensionality reduction procedure:</p>
<p>Salasnich, L., Parola, A., Reatto, L., 2002. Effective wave equations for the dynamics of cigar-shaped and disk-shaped Bose condensates. Phys. Rev. A 65, 043614. <a class="reference external" href="https://doi.org/10.1103/PhysRevA.65.043614">https://doi.org/10.1103/PhysRevA.65.043614</a></p>
</div>
</section>
<section id="dispersivecavity">
<h4>DispersiveCavity<a class="headerlink" href="#dispersivecavity" title="Link to this heading">#</a></h4>
<p><a class="reference internal" href="../api/potentials.html#torchgpe.bec2D.potentials.DispersiveCavity" title="torchgpe.bec2D.potentials.DispersiveCavity"><code class="xref py py-class docutils literal notranslate"><span class="pre">DispersiveCavity</span></code></a> describes the dispersive interaction of the BEC with a transversally driven cavity mode. When initialized, it takes the parameters:</p>
<ul class="simple">
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">lattice_depth</span></code> (the strength of the pump. Supports time-dependent parameters),</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">atomic_detuning</span></code> (the detuning of the atoms with respect to the pump),</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">cavity_detuning</span></code> (the detuning of the cavity with respect to the pump. Supports time-dependent parameters),</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">cavity_decay</span></code> (the decay rate of the cavity),</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">cavity_coupling</span></code> (the coupling constant between the gas and the cavity),</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">cavity_angle</span></code> (the angle of the cavity with respect to the horizontal),</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">pump_angle</span></code> (the angle of the pump with respect to the horizontal),</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">waist</span></code> (the waist of the gaussian pump beam).</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">cavity_probe</span></code> (the on-axis probe field. Supports time-dependent parameters).</p></li>
</ul>
<p>Note that the lattice depth is expressed in units of the recoil energy <span class="math notranslate nohighlight">\(E_r = \hbar^2 k^2 / 2m\)</span>, where the wave number <span class="math notranslate nohighlight">\(k\)</span> is computed from the <span class="math notranslate nohighlight">\(d_2\)</span> pulse of the atomic species the gas is made of, and the specified atomic detuning.
Additionally, observe that <code class="xref py py-attr docutils literal notranslate"><span class="pre">atomic_detuning</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">cavity_detuning</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">cavity_decay</span></code> have to be considered frequencies. The corresponding rates are obtained by the potential itself, by multiplying them by <span class="math notranslate nohighlight">\(2 \pi\)</span>.</p>
<p><code class="xref py py-attr docutils literal notranslate"><span class="pre">waist</span></code> is the waist of the gaussian pump beam. It defaults to infinity, which corresponds to a plane wave. Note that differently from the <a class="reference internal" href="../api/potentials.html#torchgpe.bec2D.potentials.Lattice" title="torchgpe.bec2D.potentials.Lattice"><code class="xref py py-class docutils literal notranslate"><span class="pre">Lattice</span></code></a> potential, the <a class="reference internal" href="../api/potentials.html#torchgpe.bec2D.potentials.DispersiveCavity" title="torchgpe.bec2D.potentials.DispersiveCavity"><code class="xref py py-class docutils literal notranslate"><span class="pre">DispersiveCavity</span></code></a> potential does not account for the wavefront curvature and the Gouy phase.</p>
<p>Finally, an additional on-axis probe field can be added to the potential via the <code class="xref py py-attr docutils literal notranslate"><span class="pre">cavity_probe</span></code>. This is useful to study the response of the system to a perturbation. A pre-defined probe field is defined in <a class="reference internal" href="../stubs/torchgpe.utils.potentials.probe_pulse.html#torchgpe.utils.potentials.probe_pulse" title="torchgpe.utils.potentials.probe_pulse"><code class="xref py py-meth docutils literal notranslate"><span class="pre">probe_pulse()</span></code></a></p>
<a class="reference internal image-reference" href="../_images/fundamentals_cavity_angles.svg"><img alt="Cavity angles scheme" class="align-center" src="../_images/fundamentals_cavity_angles.svg" style="width: 450px;" />
</a>
<p>The returned potential is made of three terms: the pump lattice, the cavity lattice and the pump-cavity interference.
In their simplest form (that is, when <code class="docutils literal notranslate"><span class="pre">cavity_angle</span> <span class="pre">=</span> <span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">pump_angle</span> <span class="pre">=</span> <span class="pre">np.pi</span></code> and <code class="docutils literal notranslate"><span class="pre">waist</span> <span class="pre">=</span> <span class="pre">np.Inf</span></code> ), they read:</p>
<div class="math notranslate nohighlight">
\[\text{pump_lattice}(x, y, \psi, t) = \frac{\Delta_A}{\left|\Delta_A\right|} \frac{V_0 \cdot E_{rec}}{\hbar \omega_l} \cos\left(k \cdot y\right)^2\]</div>
<div class="math notranslate nohighlight">
\[\text{cavity_lattice}(x, y, \psi, t) = \frac{g_0^2}{\Delta_A \omega_l} \left|\alpha\right|^2 \cos\left(k \cdot x\right)^2\]</div>
<div class="math notranslate nohighlight">
\[\text{interaction}(x, y, \psi, t) = \frac{g_0}{\omega_l} \sqrt{ \frac{V_0 \cdot E_{rec}}{\hbar \Delta_A}} \Re\left(\alpha\right) \cos\left(k\cdot x\right)  \cos\left(k\cdot y\right)\]</div>
<p>The total potential is then the sum of the three terms.</p>
<p>In the expressions above, we have defined the following quantities:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\Delta_A\)</span> is the pulse associated to the specified atomic detuning,</p></li>
<li><p><span class="math notranslate nohighlight">\(E_{rec}\)</span> is the recoil energy,</p></li>
<li><p><span class="math notranslate nohighlight">\(V_0\)</span> is the lattice depth in units of the recoil energy,</p></li>
<li><p><span class="math notranslate nohighlight">\(k\)</span> is the wave number of the pump lattice,</p></li>
<li><p><span class="math notranslate nohighlight">\(g_0\)</span> is the coupling strength between the gas and the cavity,</p></li>
<li><p><span class="math notranslate nohighlight">\(\alpha\)</span> is cavity field.</p></li>
</ul>
</section>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="fundamentals.gas_class.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">The Gas class</p>
      </div>
    </a>
    <a class="right-next"
       href="fundamentals.callbacks.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Callbacks</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implemented-potentials">Implemented potentials</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-potentials">Linear potentials</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#zero">Zero</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#trap">Trap</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#squarebox">SquareBox</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#roundbox">RoundBox</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lattice">Lattice</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#non-linear-potentials">Non-linear potentials</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#contact">Contact</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dispersivecavity">DispersiveCavity</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, Quantum Optics group @ ETH Zurich.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>