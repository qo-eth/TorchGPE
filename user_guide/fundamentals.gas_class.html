
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>The Gas class &#8212; TorchGPE 1.0.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css?v=d110ab36" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=8d563738"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user_guide/fundamentals.gas_class';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Potentials" href="fundamentals.potentials.html" />
    <link rel="prev" title="Basic usage" href="fundamentals.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">TorchGPE package documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-external" href="https://www.quantumoptics.ethz.ch">
    Quantum Optics group
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API reference
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/torchgpe" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-box fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/qo-eth/TorchGPE" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-external" href="https://www.quantumoptics.ethz.ch">
    Quantum Optics group
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API reference
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/torchgpe" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-box fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/qo-eth/TorchGPE" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
</form></div>
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="about.html">About the package</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">TorchGPE quickstart</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Usage</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="fundamentals.html">Basic usage</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">The Gas class</a></li>
<li class="toctree-l2"><a class="reference internal" href="fundamentals.potentials.html">Potentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="fundamentals.callbacks.html">Callbacks</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="extending_torchgpe.html">Advanced usage</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="extending_torchgpe.configuration_files.html">Using configuration files</a></li>
<li class="toctree-l2"><a class="reference internal" href="extending_torchgpe.custom_potentials.html">Defining custom potentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="extending_torchgpe.custom_callbacks.html">Defining custom callbacks</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">User Guide</a></li>
    
    
    <li class="breadcrumb-item"><a href="fundamentals.html" class="nav-link">Basic usage</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">The Gas class</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="the-gas-class">
<h1>The Gas class<a class="headerlink" href="#the-gas-class" title="Link to this heading">#</a></h1>
<p>The <a class="reference internal" href="../api/gas.html#torchgpe.bec2D.gas.Gas" title="torchgpe.bec2D.gas.Gas"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gas</span></code></a> class represents the quantum gas to be simulated.</p>
<p>It is initialized specifying the atomic species, the number of atoms, and details on the region of space to be studied. After setting a first wave function of the gas via the <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.psi.html#torchgpe.bec2D.gas.Gas.psi" title="torchgpe.bec2D.gas.Gas.psi"><code class="xref py py-attr docutils literal notranslate"><span class="pre">psi</span></code></a> or <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.psik.html#torchgpe.bec2D.gas.Gas.psik" title="torchgpe.bec2D.gas.Gas.psik"><code class="xref py py-attr docutils literal notranslate"><span class="pre">psik</span></code></a> attributes, the <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.ground_state.html#torchgpe.bec2D.gas.Gas.ground_state" title="torchgpe.bec2D.gas.Gas.ground_state"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ground_state()</span></code></a> and <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.propagate.html#torchgpe.bec2D.gas.Gas.propagate" title="torchgpe.bec2D.gas.Gas.propagate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">propagate()</span></code></a> methods can be used to evolve the wave function in time. <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.ground_state.html#torchgpe.bec2D.gas.Gas.ground_state" title="torchgpe.bec2D.gas.Gas.ground_state"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ground_state()</span></code></a> performs imaginary time evolution to find the ground state of the system, while <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.propagate.html#torchgpe.bec2D.gas.Gas.propagate" title="torchgpe.bec2D.gas.Gas.propagate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">propagate()</span></code></a> performs real time evolution to study its dynamics. Both methods use the split-step Fourier method to solve the Gross-Pitaevskii equation.</p>
<p>The atomic species is specified by the <code class="xref py py-attr docutils literal notranslate"><span class="pre">element</span></code> parameter, which is a string (<code class="docutils literal notranslate"><span class="pre">'87Rb'</span></code> by default). If <code class="xref py py-attr docutils literal notranslate"><span class="pre">element</span></code> is a species supported by GPE, its parameters are automatically loaded. The only supported species at the moment are <code class="docutils literal notranslate"><span class="pre">'87Rb'</span></code> and <code class="docutils literal notranslate"><span class="pre">'39K'</span></code>, which are defined in  <a class="reference internal" href="../stubs/torchgpe.utils.elements.elements_dict.html#torchgpe.utils.elements.elements_dict" title="torchgpe.utils.elements.elements_dict"><code class="xref py py-attr docutils literal notranslate"><span class="pre">elements_dict</span></code></a>. This is a dictionary where each element is associated with its mass and the angular frequency of its <span class="math notranslate nohighlight">\(d_2\)</span> line, e.g.:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="linenos"> 2</span><span class="kn">import</span><span class="w"> </span><span class="nn">scipy.constants</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">spconsts</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1"># dictionary stored in torchgpe.utils.elements</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="n">elements_dict</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos"> 7</span>    <span class="s2">&quot;87Rb&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="linenos"> 8</span>        <span class="s2">&quot;m&quot;</span><span class="p">:</span> <span class="n">spconsts</span><span class="o">.</span><span class="n">physical_constants</span><span class="p">[</span><span class="s2">&quot;atomic mass constant&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">87</span><span class="p">,</span>
<span class="linenos"> 9</span>        <span class="s2">&quot;omega d2&quot;</span><span class="p">:</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">384.2304844685e12</span><span class="p">,</span>
<span class="linenos">10</span>    <span class="p">},</span>
<span class="linenos">11</span>    <span class="s2">&quot;39K&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="linenos">12</span>        <span class="s2">&quot;m&quot;</span><span class="p">:</span> <span class="n">spconsts</span><span class="o">.</span><span class="n">physical_constants</span><span class="p">[</span><span class="s2">&quot;atomic mass constant&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">39</span><span class="p">,</span>
<span class="linenos">13</span>        <span class="s2">&quot;omega d2&quot;</span><span class="p">:</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">391.01617003e12</span><span class="p">,</span>
<span class="linenos">14</span>    <span class="p">},</span>
<span class="linenos">15</span><span class="p">}</span>
</pre></div>
</div>
<p>Additional atomic species can be specified by the user by adding new entries to the dictionary. Similarly, additional properties of the existing species can be added by modifying the corresponding entries.</p>
<section id="adimensionalization">
<h2>Adimensionalization<a class="headerlink" href="#adimensionalization" title="Link to this heading">#</a></h2>
<p>In order to minimize the numerical errors due to the scale of the system, the wave function is evolved in dimensionless units. The length unit is provided by the <code class="xref py py-attr docutils literal notranslate"><span class="pre">adimensionalization_length</span></code> parameter (hereafter referred to as <span class="math notranslate nohighlight">\(l\)</span>); other adimensionalization parameters are inferred from it:</p>
<ol class="arabic simple">
<li><p>adimensionalization length: <span class="math notranslate nohighlight">\(l\)</span> (available as <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.adim_length.html#torchgpe.bec2D.gas.Gas.adim_length" title="torchgpe.bec2D.gas.Gas.adim_length"><code class="xref py py-attr docutils literal notranslate"><span class="pre">adim_length</span></code></a>)</p></li>
<li><p>Adimensionalization pulse: <span class="math notranslate nohighlight">\(\omega_l = \frac{\hbar}{m l^2}\)</span> (available as <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.adim_pulse.html#torchgpe.bec2D.gas.Gas.adim_pulse" title="torchgpe.bec2D.gas.Gas.adim_pulse"><code class="xref py py-attr docutils literal notranslate"><span class="pre">adim_pulse</span></code></a>)</p></li>
<li><p>Adimensionalization time: <span class="math notranslate nohighlight">\(\tau_l = \frac{1}{\omega_l}\)</span></p></li>
<li><p>Adimensionalization energy: <span class="math notranslate nohighlight">\(E_l = \hbar \omega_l\)</span></p></li>
</ol>
<p>Therefore, to transform from adimensionalised units to SI units, one should multiply by the corresponding adimensionalization parameter. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">x_SI</span> <span class="o">=</span> <span class="n">x_adim</span> <span class="o">*</span> <span class="n">gas</span><span class="o">.</span><span class="n">adim_length</span>        <span class="c1"># lengths</span>
<span class="linenos">2</span><span class="n">w_SI</span> <span class="o">=</span> <span class="n">w_adim</span> <span class="o">*</span> <span class="n">gas</span><span class="o">.</span><span class="n">adim_pulse</span>         <span class="c1"># frequencies and pulses</span>
<span class="linenos">3</span><span class="n">t_SI</span> <span class="o">=</span> <span class="n">t_adim</span> <span class="o">/</span> <span class="n">gas</span><span class="o">.</span><span class="n">adim_pulse</span>         <span class="c1"># times</span>
<span class="linenos">4</span><span class="n">E_SI</span> <span class="o">=</span> <span class="n">E_adim</span> <span class="o">*</span> <span class="n">hbar</span> <span class="o">*</span> <span class="n">gas</span><span class="o">.</span><span class="n">adim_pulse</span>  <span class="c1"># energies</span>
</pre></div>
</div>
</section>
<section id="computational-grid">
<h2>Computational grid<a class="headerlink" href="#computational-grid" title="Link to this heading">#</a></h2>
<p>The real space wave function is defined and evolved on a grid specified by the <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.N_grid.html#torchgpe.bec2D.gas.Gas.N_grid" title="torchgpe.bec2D.gas.Gas.N_grid"><code class="xref py py-attr docutils literal notranslate"><span class="pre">N_grid</span></code></a>, <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.grid_size_x.html#torchgpe.bec2D.gas.Gas.grid_size_x" title="torchgpe.bec2D.gas.Gas.grid_size_x"><code class="xref py py-attr docutils literal notranslate"><span class="pre">grid_size_x</span></code></a> and <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.grid_size_y.html#torchgpe.bec2D.gas.Gas.grid_size_y" title="torchgpe.bec2D.gas.Gas.grid_size_y"><code class="xref py py-attr docutils literal notranslate"><span class="pre">grid_size_y</span></code></a> parameters. The grid is centered in the origin, and the grid spacing is given by <code class="docutils literal notranslate"><span class="pre">grid_size/((N_grid-1)*adimensionalization_length)</span></code>. For example, to study a wave function in a region of space <span class="math notranslate nohighlight">\(10\mu m\)</span> wide, one should initialize the <a class="reference internal" href="../api/gas.html#torchgpe.bec2D.gas.Gas" title="torchgpe.bec2D.gas.Gas"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gas</span></code></a> class with the argument <code class="docutils literal notranslate"><span class="pre">grid_size=10e-6</span></code>. Assuming <span class="math notranslate nohighlight">\(l=1\mu m\)</span> and <code class="docutils literal notranslate"><span class="pre">N_grid=101</span></code>, the resulting grid will span values from <span class="math notranslate nohighlight">\(-5\)</span> to <span class="math notranslate nohighlight">\(5\)</span> in adimensional units, with a grid spacing of <span class="math notranslate nohighlight">\(\Delta = 0.1\)</span> (corresponding to <span class="math notranslate nohighlight">\(100 \, nm\)</span> in SI units).</p>
<a class="reference internal image-reference" href="../_images/fundamentals_grid.svg"><img alt="Grid" class="align-center" src="../_images/fundamentals_grid.svg" style="width: 450px;" />
</a>
<p>Similarly, the wave function in momentum space is defined on a grid that is related to the real space one by the application of a Fourier transform. In this case, before applying the transform, we pad the wave function to reduce the presence of boundary effects. Therefore, the wave function in momentum space has <code class="docutils literal notranslate"><span class="pre">2*N_grid</span></code> points per dimension, ranging values from <span class="math notranslate nohighlight">\(-\frac{\pi}{\Delta}\)</span> to <span class="math notranslate nohighlight">\(\frac{\pi}{\Delta}\)</span> in adimensional units. The adimensional unit of momentum is given by <span class="math notranslate nohighlight">\(\frac{1}{l}\)</span> and hence the spacing between two sampled momenta is <span class="math notranslate nohighlight">\(\tilde{\Delta} = \pi/(N_{grid} \cdot \Delta)\)</span>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The grid will have <code class="docutils literal notranslate"><span class="pre">2*N_grid</span></code> points per side only if <code class="docutils literal notranslate"><span class="pre">N_grid</span></code> is even. Otherwise, the grid will have <code class="docutils literal notranslate"><span class="pre">2*N_grid-1</span></code> points per side.</p>
</div>
</section>
<section id="initialisation-of-the-wave-function">
<h2>Initialisation of the wave function<a class="headerlink" href="#initialisation-of-the-wave-function" title="Link to this heading">#</a></h2>
<p>The wave function can be initialized by assigning a value to either the <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.psi.html#torchgpe.bec2D.gas.Gas.psi" title="torchgpe.bec2D.gas.Gas.psi"><code class="xref py py-obj docutils literal notranslate"><span class="pre">psi</span></code></a> or <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.psik.html#torchgpe.bec2D.gas.Gas.psik" title="torchgpe.bec2D.gas.Gas.psik"><code class="xref py py-obj docutils literal notranslate"><span class="pre">psik</span></code></a> attributes. The <a class="reference internal" href="../api/gas.html#torchgpe.bec2D.gas.Gas" title="torchgpe.bec2D.gas.Gas"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Gas</span></code></a> class is written in such a way that the user can always read the wave function in both real and momentum space, no matter which one of the two is the last updated. In case the user tries to read the wave function in the space that is not the last updated, the wave function is automatically computed via a Fourier transform.</p>
<p>For example, to initialize the real space wave function to a Gaussian wave packet of size <span class="math notranslate nohighlight">\(1\mu m\)</span>, one can use:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kn">from</span><span class="w"> </span><span class="nn">torchgpe.bec2D</span><span class="w"> </span><span class="kn">import</span> <span class="n">Gas</span>
<span class="linenos">2</span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="linenos">3</span>
<span class="linenos">4</span><span class="n">bec</span> <span class="o">=</span> <span class="n">Gas</span><span class="p">(</span><span class="n">N_particles</span><span class="o">=</span><span class="mf">2e5</span><span class="p">,</span> <span class="n">grid_size</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
<span class="hll"><span class="linenos">5</span><span class="n">bec</span><span class="o">.</span><span class="n">psi</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">bec</span><span class="o">.</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">bec</span><span class="o">.</span><span class="n">Y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mf">1e-6</span><span class="o">/</span><span class="n">bec</span><span class="o">.</span><span class="n">adim_length</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
</span></pre></div>
</div>
<p>Note that since the grid is expressed in adimensional units, the Gaussian width must be divided by the adimensionalization length.
Also, normalizing the wave function is not necessary, as the library takes care of it.</p>
</section>
<section id="evolution">
<span id="fundamentals-gas-class-evolution"></span><h2>Evolution<a class="headerlink" href="#evolution" title="Link to this heading">#</a></h2>
<p>GPE evolves the wave function of the gas integrating the Gross-Pitaevskii equation in time. The equation is solved using the split-step Fourier method, which consists in alternating the application of the kinetic and potential operators in real and momentum space.</p>
<p>Consider an Hamiltonian <span class="math notranslate nohighlight">\(\hat{H} = \hat{T} + \hat{V}\)</span>, where <span class="math notranslate nohighlight">\(\hat{T}\)</span> is the kinetic term (diagonal in momentum space) and <span class="math notranslate nohighlight">\(\hat{V}\)</span> is the potential one, assumed diagonal in real space. The time evolution from time <span class="math notranslate nohighlight">\(t\)</span> to time <span class="math notranslate nohighlight">\(t+\Delta t\)</span> is given by the operator</p>
<div class="math notranslate nohighlight">
\[U = \exp(-\frac{i}{\hbar}\hat{H}\Delta t).\]</div>
<p>Since <span class="math notranslate nohighlight">\(\hat{T}\)</span> and <span class="math notranslate nohighlight">\(\hat{V}\)</span> don’t commute, the operator <span class="math notranslate nohighlight">\(U\)</span> cannot be factorized. However, defining the dimensionless operators</p>
<div class="math notranslate nohighlight">
\[\tilde{T} = -\frac{i}{\hbar}\hat{T}\Delta t \quad \text{and} \quad \tilde{V} = -\frac{i}{\hbar}\hat{V}\Delta t\]</div>
<p>and making use of the Baker-Campbell-Hausdorff formula, one can write</p>
<div class="math notranslate nohighlight">
\[\begin{split}U &amp;= \exp(\tilde{T}+\tilde{V}) = \exp(\tilde{T}/2 + \tilde{V} + \tilde{T}/2)\\
  &amp;= e^{\tilde{T}/2}e^{\tilde{V} + \tilde{T}/2}\exp(-\frac{1}{2}\left[\tilde{T}/2,\tilde{V}\right] + \mathcal{O}\left(\Delta t^3\right))\\
  &amp;= e^{\tilde{T}/2}e^{\tilde{V}}e^{\tilde{T}/2}\exp(-\frac{1}{2}\left[\tilde{T}/2,\tilde{V}\right] -\frac{1}{2}\left[\tilde{V},\tilde{T}/2\right] + \mathcal{O}\left(\Delta t^3\right))\\
  &amp;= e^{\tilde{T}/2}e^{\tilde{V}}e^{\tilde{T}/2}e^{\mathcal{O}\left(\Delta t^3\right)}.\end{split}\]</div>
<p>That is, the subsequent application of the kinetic propagator <span class="math notranslate nohighlight">\(e^{\tilde{T}/2}\)</span> followed by the potential one <span class="math notranslate nohighlight">\(e^{\tilde{V}}\)</span> and the kinetic propagator one last time is equivalent to the application of the full operator <span class="math notranslate nohighlight">\(U\)</span> up to third order in <span class="math notranslate nohighlight">\(\Delta t\)</span>.</p>
<section id="ground-state">
<h3>Ground state<a class="headerlink" href="#ground-state" title="Link to this heading">#</a></h3>
<p>The <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.ground_state.html#torchgpe.bec2D.gas.Gas.ground_state" title="torchgpe.bec2D.gas.Gas.ground_state"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ground_state()</span></code></a> method uses the split-step Fourier method to evolve the wave function in imaginary time to find the ground state of the system. The method takes as input the number of iterations to perform, the time step to use, the list of the potentials acting on the system and, optionally, a set of callbacks to monitor the evolution. Note that imaginary time evolution does not support the use of a time-dependent potential. After checking that the time step is indeed a purely imaginary number, the method integrates the Gross Pitaevskii equation taking care of renormalising the wave function after each step. At the end of the propagation, the <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.psi.html#torchgpe.bec2D.gas.Gas.psi" title="torchgpe.bec2D.gas.Gas.psi"><code class="xref py py-obj docutils literal notranslate"><span class="pre">psi</span></code></a> and <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.psik.html#torchgpe.bec2D.gas.Gas.psik" title="torchgpe.bec2D.gas.Gas.psik"><code class="xref py py-obj docutils literal notranslate"><span class="pre">psik</span></code></a> attributes are updated to the final wave function.</p>
</section>
<section id="real-time-propagation">
<h3>Real time propagation<a class="headerlink" href="#real-time-propagation" title="Link to this heading">#</a></h3>
<p>The <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.propagate.html#torchgpe.bec2D.gas.Gas.propagate" title="torchgpe.bec2D.gas.Gas.propagate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">propagate()</span></code></a> method uses the split-step Fourier method to evolve the wave function in real time. The method takes as input the time step to use, the final time, the list of the potentials acting on the system and, optionally, a set of callbacks to monitor the evolution. Note that the time step can be slightly adjusted to ensure that the wave function is evaluated at the final time. The method integrates the Gross Pitaevskii equation taking care of renormalising the wave function after each step. At the end of the propagation, the <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.psi.html#torchgpe.bec2D.gas.Gas.psi" title="torchgpe.bec2D.gas.Gas.psi"><code class="xref py py-obj docutils literal notranslate"><span class="pre">psi</span></code></a> and <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.psik.html#torchgpe.bec2D.gas.Gas.psik" title="torchgpe.bec2D.gas.Gas.psik"><code class="xref py py-obj docutils literal notranslate"><span class="pre">psik</span></code></a> attributes are updated to the final wave function.</p>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="fundamentals.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Basic usage</p>
      </div>
    </a>
    <a class="right-next"
       href="fundamentals.potentials.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Potentials</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adimensionalization">Adimensionalization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computational-grid">Computational grid</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#initialisation-of-the-wave-function">Initialisation of the wave function</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evolution">Evolution</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ground-state">Ground state</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#real-time-propagation">Real time propagation</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, Quantum Optics group @ ETH Zurich.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>