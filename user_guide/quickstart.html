
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>TorchGPE quickstart &#8212; TorchGPE 1.0.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css?v=d110ab36" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=8d563738"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user_guide/quickstart';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Basic usage" href="fundamentals.html" />
    <link rel="prev" title="Installation" href="installation.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">TorchGPE package documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-external" href="https://www.quantumoptics.ethz.ch">
    Quantum Optics group
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API reference
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/torchgpe" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-box fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/qo-eth/TorchGPE" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-external" href="https://www.quantumoptics.ethz.ch">
    Quantum Optics group
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API reference
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/torchgpe" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-box fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/qo-eth/TorchGPE" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
</form></div>
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="about.html">About the package</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">TorchGPE quickstart</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Usage</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="fundamentals.html">Basic usage</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="fundamentals.gas_class.html">The Gas class</a></li>
<li class="toctree-l2"><a class="reference internal" href="fundamentals.potentials.html">Potentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="fundamentals.callbacks.html">Callbacks</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="extending_torchgpe.html">Advanced usage</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="extending_torchgpe.configuration_files.html">Using configuration files</a></li>
<li class="toctree-l2"><a class="reference internal" href="extending_torchgpe.custom_potentials.html">Defining custom potentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="extending_torchgpe.custom_callbacks.html">Defining custom callbacks</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">User Guide</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">TorchGPE quickstart</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="torchgpe-quickstart">
<h1>TorchGPE quickstart<a class="headerlink" href="#torchgpe-quickstart" title="Link to this heading">#</a></h1>
<p>This page contains a quick introduction to the TorchGPE package, helping new users run their first simulations.</p>
<section id="creating-a-bec">
<h2>Creating a BEC<a class="headerlink" href="#creating-a-bec" title="Link to this heading">#</a></h2>
<p>At the very core of TorchGPE, there is the <a class="reference internal" href="../api/gas.html#torchgpe.bec2D.gas.Gas" title="torchgpe.bec2D.gas.Gas"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gas</span></code></a> class. An instance of <a class="reference internal" href="../api/gas.html#torchgpe.bec2D.gas.Gas" title="torchgpe.bec2D.gas.Gas"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gas</span></code></a> describes a Bose-Einstein condensate, stores its wave function both in real and momentum space and manages its evolution. We can create a <span class="math notranslate nohighlight">\(^{87}\text{Rb}\)</span> BEC by importing the <a class="reference internal" href="../api/gas.html#torchgpe.bec2D.gas.Gas" title="torchgpe.bec2D.gas.Gas"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gas</span></code></a> class from the sub-module of bidimensional simulations and instantiating it:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kn">from</span><span class="w"> </span><span class="nn">torchgpe.bec2D</span><span class="w"> </span><span class="kn">import</span> <span class="n">Gas</span>
<span class="linenos">2</span>
<span class="linenos">3</span><span class="n">bec</span> <span class="o">=</span> <span class="n">Gas</span><span class="p">(</span><span class="n">N_particles</span><span class="o">=</span><span class="mf">2e5</span><span class="p">,</span> <span class="n">grid_size</span><span class="o">=</span><span class="mf">3e-5</span><span class="p">)</span>
</pre></div>
</div>
<p>When <a class="reference internal" href="../api/gas.html#torchgpe.bec2D.gas.Gas" title="torchgpe.bec2D.gas.Gas"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gas</span></code></a> is instantiated, multiple parameters can be set. For example, different atomic species can be used, as well as different numbers of particles. It can be specified if TorchGPE should run on CPU or GPU and also the precision of the variables to use (e.g. whether to store floats in 32 or 64 bits). Moreover, the wave function is sampled on a grid of points whose number and distance can also be specified when instantiating the gas. In the example, we are studying a square region of space of side <span class="math notranslate nohighlight">\(30 \mu m\)</span>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>See <a class="reference internal" href="fundamentals.gas_class.html"><span class="doc">The Gas class</span></a> for a detailed description of the <a class="reference internal" href="../api/gas.html#torchgpe.bec2D.gas.Gas" title="torchgpe.bec2D.gas.Gas"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gas</span></code></a> class and its parameters.</p>
</div>
</section>
<section id="initializing-the-wave-function">
<h2>Initializing the wave function<a class="headerlink" href="#initializing-the-wave-function" title="Link to this heading">#</a></h2>
<p>Regardless of whether we want to use TorchGPE to find the ground state of the BEC or to propagate its wave function in real time, the first thing to do after instantiating the <a class="reference internal" href="../api/gas.html#torchgpe.bec2D.gas.Gas" title="torchgpe.bec2D.gas.Gas"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gas</span></code></a> is to define an initial wave function. This can be done by setting the attributes <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.psi.html#torchgpe.bec2D.gas.Gas.psi" title="torchgpe.bec2D.gas.Gas.psi"><code class="xref py py-attr docutils literal notranslate"><span class="pre">psi</span></code></a> or <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.psik.html#torchgpe.bec2D.gas.Gas.psik" title="torchgpe.bec2D.gas.Gas.psik"><code class="xref py py-attr docutils literal notranslate"><span class="pre">psik</span></code></a>. The two are related by a Fourier transform, and hence setting either one of the two suffices. For example, we can initialize the BEC with a Gaussian wave function in real space as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kn">from</span><span class="w"> </span><span class="nn">torchgpe.bec2D</span><span class="w"> </span><span class="kn">import</span> <span class="n">Gas</span>
<span class="linenos">2</span>
<span class="hll"><span class="linenos">3</span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
</span><span class="linenos">4</span>
<span class="linenos">5</span><span class="n">bec</span> <span class="o">=</span> <span class="n">Gas</span><span class="p">(</span><span class="n">N_particles</span><span class="o">=</span><span class="mf">2e5</span><span class="p">,</span> <span class="n">grid_size</span><span class="o">=</span><span class="mf">3e-5</span><span class="p">)</span>
<span class="linenos">6</span>
<span class="hll"><span class="linenos">7</span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">1e-6</span>
</span><span class="hll"><span class="linenos">8</span><span class="n">bec</span><span class="o">.</span><span class="n">psi</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">bec</span><span class="o">.</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">bec</span><span class="o">.</span><span class="n">Y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">sigma</span><span class="o">/</span><span class="n">bec</span><span class="o">.</span><span class="n">adim_length</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
</span></pre></div>
</div>
<p>In the example above, we generate a Gaussian wave packet evaluated on the real-space grid given by <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.X.html#torchgpe.bec2D.gas.Gas.X" title="torchgpe.bec2D.gas.Gas.X"><code class="xref py py-attr docutils literal notranslate"><span class="pre">X</span></code></a> and <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.Y.html#torchgpe.bec2D.gas.Gas.Y" title="torchgpe.bec2D.gas.Gas.Y"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Y</span></code></a>. The size of the packet is specified by <code class="xref py py-obj docutils literal notranslate"><span class="pre">sigma</span></code>, which has been set to <span class="math notranslate nohighlight">\(1\,\mu m\)</span>. Observe that the wave function does not need to be normalized as TorchGPE will do it during the initialization. Additionally, note that TorchGPE works with adimensionalized values. When instantiating <a class="reference internal" href="../api/gas.html#torchgpe.bec2D.gas.Gas" title="torchgpe.bec2D.gas.Gas"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gas</span></code></a>, the optional parameter <code class="xref py py-obj docutils literal notranslate"><span class="pre">adimensionalization_length</span></code> can be specified (defaults to <span class="math notranslate nohighlight">\(1\,\mu m\)</span>). The coordinates <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.X.html#torchgpe.bec2D.gas.Gas.X" title="torchgpe.bec2D.gas.Gas.X"><code class="xref py py-attr docutils literal notranslate"><span class="pre">X</span></code></a> and <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.Y.html#torchgpe.bec2D.gas.Gas.Y" title="torchgpe.bec2D.gas.Gas.Y"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Y</span></code></a> are then expressed in units of this adimensionalization length (<span class="math notranslate nohighlight">\(a_l\)</span>), stored in <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.adim_length.html#torchgpe.bec2D.gas.Gas.adim_length" title="torchgpe.bec2D.gas.Gas.adim_length"><code class="xref py py-attr docutils literal notranslate"><span class="pre">adim_length</span></code></a>. Consequently, to express the size of the Gaussian packet in SI units we have to rescale its value by the adimensionalization length <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.adim_length.html#torchgpe.bec2D.gas.Gas.adim_length" title="torchgpe.bec2D.gas.Gas.adim_length"><code class="xref py py-attr docutils literal notranslate"><span class="pre">adim_length</span></code></a>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>See <a class="reference internal" href="fundamentals.gas_class.html"><span class="doc">The Gas class</span></a> for more information on the adimensionalization.</p>
</div>
</section>
<section id="initializing-the-potentials">
<h2>Initializing the potentials<a class="headerlink" href="#initializing-the-potentials" title="Link to this heading">#</a></h2>
<p>Once the wave function has been defined, we can run our first simulation with TorchGPE. To do so, we have to import the potentials defining our system. For this simple example, we will study a trapped gas with contact interactions, comparing it to the Thomas Fermi profile.</p>
<p>Both the harmonic trap and the contact interaction potentials are already implemented in TorchGPE, and can be easily imported and set up:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span><span class="w"> </span><span class="nn">torchgpe.bec2D</span><span class="w"> </span><span class="kn">import</span> <span class="n">Gas</span>
<span class="linenos"> 2</span><span class="kn">from</span><span class="w"> </span><span class="nn">torchgpe.bec2D.potentials</span><span class="w"> </span><span class="kn">import</span> <span class="n">Contact</span><span class="p">,</span> <span class="n">Trap</span>
<span class="linenos"> 3</span>
<span class="hll"><span class="linenos"> 4</span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
</span><span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="n">bec</span> <span class="o">=</span> <span class="n">Gas</span><span class="p">(</span><span class="n">N_particles</span><span class="o">=</span><span class="mf">2e5</span><span class="p">,</span> <span class="n">grid_size</span><span class="o">=</span><span class="mf">3e-5</span><span class="p">)</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">1e-6</span>
<span class="linenos"> 9</span><span class="n">bec</span><span class="o">.</span><span class="n">psi</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">bec</span><span class="o">.</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">bec</span><span class="o">.</span><span class="n">Y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">sigma</span><span class="o">/</span><span class="n">bec</span><span class="o">.</span><span class="n">adim_length</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
<span class="linenos">10</span>
<span class="hll"><span class="linenos">11</span><span class="n">contact</span> <span class="o">=</span> <span class="n">Contact</span><span class="p">(</span><span class="n">a_s</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
</span><span class="hll"><span class="linenos">12</span><span class="n">trap</span> <span class="o">=</span> <span class="n">Trap</span><span class="p">(</span><span class="n">omegax</span> <span class="o">=</span> <span class="mi">400</span><span class="p">,</span> <span class="n">omegay</span> <span class="o">=</span> <span class="mi">400</span><span class="p">)</span>
</span></pre></div>
</div>
<p>The code above initializes a harmonic trap with frequencies along <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> of <span class="math notranslate nohighlight">\(400\,\text{Hz}\)</span>, and sets up contact interactions between the particles with a scattering length of <span class="math notranslate nohighlight">\(100\,a_{\mathrm{Bohr}}\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To account for the missing 3-rd dimension, the <a class="reference internal" href="../api/potentials.html#torchgpe.bec2D.potentials.Contact" title="torchgpe.bec2D.potentials.Contact"><code class="xref py py-class docutils literal notranslate"><span class="pre">Contact</span></code></a> potential rescales the scattering length by the optional parameter <code class="docutils literal notranslate"><span class="pre">a_orth</span></code> (defaults to <span class="math notranslate nohighlight">\(1\,\mu m\)</span>). In the weakly interacting limit, <code class="docutils literal notranslate"><span class="pre">a_orth</span></code> is well approximated by the length of a harmonic oscillator with a frequency equal to that of the transversal trap. See <a class="reference internal" href="fundamentals.potentials.html#fundamentals-potentials-contact"><span class="std std-ref">Contact</span></a> for more information.</p>
</div>
</section>
<section id="imaginary-time-propagation">
<h2>Imaginary time propagation<a class="headerlink" href="#imaginary-time-propagation" title="Link to this heading">#</a></h2>
<p>At this point we can just call the <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.ground_state.html#torchgpe.bec2D.gas.Gas.ground_state" title="torchgpe.bec2D.gas.Gas.ground_state"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ground_state()</span></code></a> function to run imaginary time propagation and compute the ground state wave function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span><span class="w"> </span><span class="nn">torchgpe.bec2D</span><span class="w"> </span><span class="kn">import</span> <span class="n">Gas</span>
<span class="linenos"> 2</span><span class="kn">from</span><span class="w"> </span><span class="nn">torchgpe.bec2D.potentials</span><span class="w"> </span><span class="kn">import</span> <span class="n">Contact</span><span class="p">,</span> <span class="n">Trap</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="n">bec</span> <span class="o">=</span> <span class="n">Gas</span><span class="p">(</span><span class="n">N_particles</span><span class="o">=</span><span class="mf">2e5</span><span class="p">,</span> <span class="n">grid_size</span><span class="o">=</span><span class="mf">3e-5</span><span class="p">)</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">1e-6</span>
<span class="linenos"> 9</span><span class="n">bec</span><span class="o">.</span><span class="n">psi</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">bec</span><span class="o">.</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">bec</span><span class="o">.</span><span class="n">Y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">sigma</span><span class="o">/</span><span class="n">bec</span><span class="o">.</span><span class="n">adim_length</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="n">contact</span> <span class="o">=</span> <span class="n">Contact</span><span class="p">(</span><span class="n">a_s</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
<span class="linenos">12</span><span class="n">trap</span> <span class="o">=</span> <span class="n">Trap</span><span class="p">(</span><span class="n">omegax</span> <span class="o">=</span> <span class="mi">400</span><span class="p">,</span> <span class="n">omegay</span> <span class="o">=</span> <span class="mi">400</span><span class="p">)</span>
<span class="linenos">13</span>
<span class="hll"><span class="linenos">14</span><span class="n">bec</span><span class="o">.</span><span class="n">ground_state</span><span class="p">(</span><span class="n">potentials</span><span class="o">=</span><span class="p">[</span><span class="n">trap</span><span class="p">,</span> <span class="n">contact</span><span class="p">],</span> <span class="n">N_iterations</span><span class="o">=</span><span class="mf">1e4</span><span class="p">)</span>
</span></pre></div>
</div>
<p><a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.ground_state.html#torchgpe.bec2D.gas.Gas.ground_state" title="torchgpe.bec2D.gas.Gas.ground_state"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ground_state()</span></code></a> allows for the definition of multiple runtime parameters, but their discussion goes beyond what is needed for this simple quickstart guide.
When <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.ground_state.html#torchgpe.bec2D.gas.Gas.ground_state" title="torchgpe.bec2D.gas.Gas.ground_state"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ground_state()</span></code></a> is called, the initial wave function we specified is evolved in imaginary time for a fixed number of iterations (<span class="math notranslate nohighlight">\(10^4\)</span> in this example). Once the propagation is complete, the updated wave function can be accessed via the <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.psi.html#torchgpe.bec2D.gas.Gas.psi" title="torchgpe.bec2D.gas.Gas.psi"><code class="xref py py-attr docutils literal notranslate"><span class="pre">psi</span></code></a> attribute. The error committed during the propagation is related to the number of iterations and the time step used.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>See <a class="reference internal" href="fundamentals.gas_class.html#fundamentals-gas-class-evolution"><span class="std std-ref">Evolution</span></a> for more information on the propagation via the Split-Step Fourier method, and <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.ground_state.html#torchgpe.bec2D.gas.Gas.ground_state" title="torchgpe.bec2D.gas.Gas.ground_state"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ground_state()</span></code></a> for details on the runtime parameters.</p>
</div>
<p>Plotting a section of the density profile <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.density.html#torchgpe.bec2D.gas.Gas.density" title="torchgpe.bec2D.gas.Gas.density"><code class="xref py py-attr docutils literal notranslate"><span class="pre">density</span></code></a>, we can compare its shape to the theoretical one given by the Thomas-Fermi approximation. In the figure below we show in blue the result coming from the simulation with the TorchGPE package, together with the Thomas-Fermi profile (dashed red).</p>
<a class="reference internal image-reference" href="../_images/quickstart_thomas_fermi.svg"><img alt="Comparison with the Thomas Fermi profile" class="align-center" src="../_images/quickstart_thomas_fermi.svg" style="width: 600px;" />
</a>
<p>The two curves perfectly overlap. Observe that the scale on the <span class="math notranslate nohighlight">\(x\)</span> axis is in adimensionalized units. Multiplying by the adimensionalization lenght one finds the coordinates in SI units.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>See <a class="reference internal" href="fundamentals.gas_class.html"><span class="doc">The Gas class</span></a> for more information on the adimensionalization.</p>
</div>
</section>
<section id="real-time-propagation">
<h2>Real time propagation<a class="headerlink" href="#real-time-propagation" title="Link to this heading">#</a></h2>
<p>The ground state wave function we just computed can be then evolved in real time under static or time-dependent potentials. For example, we can imagine that the gas is in a cavity and we slowly increase the strength of a transverse pump. <a class="reference internal" href="../api/potentials.html#torchgpe.bec2D.potentials.DispersiveCavity" title="torchgpe.bec2D.potentials.DispersiveCavity"><code class="xref py py-class docutils literal notranslate"><span class="pre">DispersiveCavity</span></code></a> implements a transversally pumped cavity potential, where the strength of the pump can either be a constant or change in time. For this example, we increase the pump strength according to an s-shaped function from <span class="math notranslate nohighlight">\(0\)</span> to <span class="math notranslate nohighlight">\(15\)</span> recoil energies in <span class="math notranslate nohighlight">\(5 \text{ms}\)</span>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span><span class="w"> </span><span class="nn">torchgpe.bec2D</span><span class="w"> </span><span class="kn">import</span> <span class="n">Gas</span>
<span class="hll"><span class="linenos"> 2</span><span class="kn">from</span><span class="w"> </span><span class="nn">torchgpe.bec2D.potentials</span><span class="w"> </span><span class="kn">import</span> <span class="n">Contact</span><span class="p">,</span> <span class="n">Trap</span><span class="p">,</span> <span class="n">DispersiveCavity</span>
</span><span class="hll"><span class="linenos"> 3</span><span class="kn">from</span><span class="w"> </span><span class="nn">torchgpe.utils.potentials</span><span class="w"> </span><span class="kn">import</span> <span class="n">s_ramp</span>
</span><span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="n">bec</span> <span class="o">=</span> <span class="n">Gas</span><span class="p">(</span><span class="n">N_particles</span><span class="o">=</span><span class="mf">2e5</span><span class="p">,</span> <span class="n">grid_size</span><span class="o">=</span><span class="mf">3e-5</span><span class="p">)</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">1e-6</span>
<span class="linenos">10</span><span class="n">bec</span><span class="o">.</span><span class="n">psi</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">bec</span><span class="o">.</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">bec</span><span class="o">.</span><span class="n">Y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">sigma</span><span class="o">/</span><span class="n">bec</span><span class="o">.</span><span class="n">adim_length</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="n">contact</span> <span class="o">=</span> <span class="n">Contact</span><span class="p">(</span><span class="n">a_s</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
<span class="linenos">13</span><span class="n">trap</span> <span class="o">=</span> <span class="n">Trap</span><span class="p">(</span><span class="n">omegax</span> <span class="o">=</span> <span class="mi">400</span><span class="p">,</span> <span class="n">omegay</span> <span class="o">=</span> <span class="mi">400</span><span class="p">)</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="n">bec</span><span class="o">.</span><span class="n">ground_state</span><span class="p">(</span><span class="n">potentials</span><span class="o">=</span><span class="p">[</span><span class="n">trap</span><span class="p">,</span> <span class="n">contact</span><span class="p">],</span> <span class="n">N_iterations</span><span class="o">=</span><span class="mf">1e4</span><span class="p">)</span>
<span class="linenos">16</span>
<span class="hll"><span class="linenos">17</span><span class="n">depth</span> <span class="o">=</span> <span class="n">s_ramp</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mf">5e-3</span><span class="p">)</span>
</span><span class="hll"><span class="linenos">18</span><span class="n">cavity</span> <span class="o">=</span> <span class="n">DispersiveCavity</span><span class="p">(</span><span class="n">lattice_depth</span><span class="o">=</span><span class="n">depth</span><span class="p">,</span> <span class="n">cavity_detuning</span><span class="o">=-</span><span class="mf">15e6</span><span class="p">,</span> <span class="n">atomic_detuning</span><span class="o">=-</span><span class="mf">76.6e9</span><span class="p">,</span> <span class="n">cavity_decay</span><span class="o">=</span><span class="mf">150e3</span><span class="p">,</span> <span class="n">cavity_coupling</span><span class="o">=</span><span class="mf">1.95e6</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Note that we use the pre-defined function <a class="reference internal" href="../stubs/torchgpe.utils.potentials.s_ramp.html#torchgpe.utils.potentials.s_ramp" title="torchgpe.utils.potentials.s_ramp"><code class="xref py py-meth docutils literal notranslate"><span class="pre">s_ramp()</span></code></a>, which returns a callable. Similarly, the <a class="reference internal" href="../stubs/torchgpe.utils.potentials.linear_ramp.html#torchgpe.utils.potentials.linear_ramp" title="torchgpe.utils.potentials.linear_ramp"><code class="xref py py-meth docutils literal notranslate"><span class="pre">linear_ramp()</span></code></a> and <a class="reference internal" href="../stubs/torchgpe.utils.potentials.quench.html#torchgpe.utils.potentials.quench" title="torchgpe.utils.potentials.quench"><code class="xref py py-meth docutils literal notranslate"><span class="pre">quench()</span></code></a> implement a linear ramp and a sudden quench, respectively. In addition, any custom single-valued function of time can be used to define the pump strength.</p>
<p><a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.propagate.html#torchgpe.bec2D.gas.Gas.propagate" title="torchgpe.bec2D.gas.Gas.propagate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">propagate()</span></code></a> performs the real time propagation in a specified time range, discretising it in steps of a given duration. For example, we can propagate the wave function for <span class="math notranslate nohighlight">\(10\,\text{ms}\)</span> in steps of <span class="math notranslate nohighlight">\(1\,\mu\text{s}\)</span>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span><span class="w"> </span><span class="nn">torchgpe.bec2D</span><span class="w"> </span><span class="kn">import</span> <span class="n">Gas</span>
<span class="linenos"> 2</span><span class="kn">from</span><span class="w"> </span><span class="nn">torchgpe.bec2D.potentials</span><span class="w"> </span><span class="kn">import</span> <span class="n">Contact</span><span class="p">,</span> <span class="n">Trap</span><span class="p">,</span> <span class="n">DispersiveCavity</span>
<span class="linenos"> 3</span><span class="kn">from</span><span class="w"> </span><span class="nn">torchgpe.utils.potentials</span> <span class="n">imports_ramp</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="n">bec</span> <span class="o">=</span> <span class="n">Gas</span><span class="p">(</span><span class="n">N_particles</span><span class="o">=</span><span class="mf">2e5</span><span class="p">,</span> <span class="n">grid_size</span><span class="o">=</span><span class="mf">3e-5</span><span class="p">)</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">1e-6</span>
<span class="linenos">10</span><span class="n">bec</span><span class="o">.</span><span class="n">psi</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">bec</span><span class="o">.</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">bec</span><span class="o">.</span><span class="n">Y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">sigma</span><span class="o">/</span><span class="n">bec</span><span class="o">.</span><span class="n">adim_length</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="n">contact</span> <span class="o">=</span> <span class="n">Contact</span><span class="p">(</span><span class="n">a_s</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
<span class="linenos">13</span><span class="n">trap</span> <span class="o">=</span> <span class="n">Trap</span><span class="p">(</span><span class="n">omegax</span> <span class="o">=</span> <span class="mi">400</span><span class="p">,</span> <span class="n">omegay</span> <span class="o">=</span> <span class="mi">400</span><span class="p">)</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="n">bec</span><span class="o">.</span><span class="n">ground_state</span><span class="p">(</span><span class="n">potentials</span><span class="o">=</span><span class="p">[</span><span class="n">trap</span><span class="p">,</span> <span class="n">contact</span><span class="p">],</span> <span class="n">N_iterations</span><span class="o">=</span><span class="mf">1e4</span><span class="p">)</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="n">depth</span> <span class="o">=</span> <span class="n">s_ramp</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mf">5e-3</span><span class="p">)</span>
<span class="linenos">18</span><span class="n">cavity</span> <span class="o">=</span> <span class="n">DispersiveCavity</span><span class="p">(</span><span class="n">lattice_depth</span><span class="o">=</span><span class="n">depth</span><span class="p">,</span> <span class="n">cavity_detuning</span><span class="o">=-</span><span class="mf">15e6</span><span class="p">,</span> <span class="n">atomic_detuning</span><span class="o">=-</span><span class="mf">76.6e9</span><span class="p">,</span> <span class="n">cavity_decay</span><span class="o">=</span><span class="mf">150e3</span><span class="p">,</span> <span class="n">cavity_coupling</span><span class="o">=</span><span class="mf">1.95e6</span><span class="p">)</span>
<span class="linenos">19</span>
<span class="hll"><span class="linenos">20</span><span class="n">bec</span><span class="o">.</span><span class="n">propagate</span><span class="p">(</span><span class="mf">10e-3</span><span class="p">,</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="p">[</span><span class="n">cavity</span><span class="p">,</span> <span class="n">trap</span><span class="p">,</span> <span class="n">contact</span><span class="p">])</span>
</span></pre></div>
</div>
<p>When <a class="reference internal" href="../stubs/torchgpe.bec2D.gas.Gas.propagate.html#torchgpe.bec2D.gas.Gas.propagate" title="torchgpe.bec2D.gas.Gas.propagate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">propagate()</span></code></a> is called, the wave function of the gas is evolved in real time. Before running the code, however, we introduce a useful concept that allows us to monitor the evolution of the wave function during the propagation, that is the one of <cite>callback</cite>. Callbacks are classes whose instances can be provided to the evolution method and that can execute custom snippets of code after each step of the propagation. For example, the <a class="reference internal" href="../api/callbacks.html#torchgpe.bec2D.callbacks.Animation" title="torchgpe.bec2D.callbacks.Animation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Animation</span></code></a> callback allows to plot the evolution in time of the cloud density both in real and momentum space, its phase in real space and the potential landscape. It also allows monitoring of the cavity field and the value of time-dependent variables like the lattice depth in this example.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>See <a class="reference internal" href="fundamentals.callbacks.html"><span class="doc">Callbacks</span></a> for more information on the implemented callbacks.</p>
</div>
<p>The code below uses the <a class="reference internal" href="../api/callbacks.html#torchgpe.bec2D.callbacks.Animation" title="torchgpe.bec2D.callbacks.Animation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Animation</span></code></a> callback to produce a video of the evolution of the density of the cloud and the cavity field:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span><span class="w"> </span><span class="nn">torchgpe.bec2D</span><span class="w"> </span><span class="kn">import</span> <span class="n">Gas</span>
<span class="linenos"> 2</span><span class="kn">from</span><span class="w"> </span><span class="nn">torchgpe.bec2D.potentials</span><span class="w"> </span><span class="kn">import</span> <span class="n">Contact</span><span class="p">,</span> <span class="n">Trap</span><span class="p">,</span> <span class="n">DispersiveCavity</span>
<span class="linenos"> 3</span><span class="kn">from</span><span class="w"> </span><span class="nn">torchgpe.utils.potentials</span><span class="w"> </span><span class="kn">import</span> <span class="n">s_ramp</span>
<span class="hll"><span class="linenos"> 4</span><span class="kn">from</span><span class="w"> </span><span class="nn">torchgpe.bec2D.callbacks</span><span class="w"> </span><span class="kn">import</span> <span class="n">Animation</span>
</span><span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="n">bec</span> <span class="o">=</span> <span class="n">Gas</span><span class="p">(</span><span class="n">N_particles</span><span class="o">=</span><span class="mf">2e5</span><span class="p">,</span> <span class="n">grid_size</span><span class="o">=</span><span class="mf">3e-5</span><span class="p">)</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">1e-6</span>
<span class="linenos">11</span><span class="n">bec</span><span class="o">.</span><span class="n">psi</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">bec</span><span class="o">.</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">bec</span><span class="o">.</span><span class="n">Y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">sigma</span><span class="o">/</span><span class="n">bec</span><span class="o">.</span><span class="n">adim_length</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="n">contact</span> <span class="o">=</span> <span class="n">Contact</span><span class="p">(</span><span class="n">a_s</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
<span class="linenos">14</span><span class="n">trap</span> <span class="o">=</span> <span class="n">Trap</span><span class="p">(</span><span class="n">omegax</span> <span class="o">=</span> <span class="mi">400</span><span class="p">,</span> <span class="n">omegay</span> <span class="o">=</span> <span class="mi">400</span><span class="p">)</span>
<span class="linenos">15</span>
<span class="linenos">16</span><span class="n">bec</span><span class="o">.</span><span class="n">ground_state</span><span class="p">(</span><span class="n">potentials</span><span class="o">=</span><span class="p">[</span><span class="n">trap</span><span class="p">,</span> <span class="n">contact</span><span class="p">],</span> <span class="n">N_iterations</span><span class="o">=</span><span class="mf">1e4</span><span class="p">)</span>
<span class="linenos">17</span>
<span class="linenos">18</span><span class="n">depth</span> <span class="o">=</span> <span class="n">s_ramp</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mf">5e-3</span><span class="p">)</span>
<span class="linenos">19</span><span class="n">cavity</span> <span class="o">=</span> <span class="n">DispersiveCavity</span><span class="p">(</span><span class="n">lattice_depth</span><span class="o">=</span><span class="n">depth</span><span class="p">,</span> <span class="n">cavity_detuning</span><span class="o">=-</span><span class="mf">15e6</span><span class="p">,</span> <span class="n">atomic_detuning</span><span class="o">=-</span><span class="mf">76.6e9</span><span class="p">,</span> <span class="n">cavity_decay</span><span class="o">=</span><span class="mf">150e3</span><span class="p">,</span> <span class="n">cavity_coupling</span><span class="o">=</span><span class="mf">1.95e6</span><span class="p">)</span>
<span class="linenos">20</span>
<span class="hll"><span class="linenos">21</span><span class="n">animation</span> <span class="o">=</span> <span class="n">Animation</span><span class="p">(</span><span class="s2">&quot;/path/to/file/animation.mp4&quot;</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">densityk</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">potentials</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cavities</span><span class="o">=</span><span class="p">[</span><span class="n">cavity</span><span class="p">],</span> <span class="n">time_dependent_variables</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;Pump strength&quot;</span><span class="p">,</span> <span class="n">depth</span><span class="p">)],</span> <span class="n">save_every</span><span class="o">=</span><span class="mi">33</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">cores</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</span><span class="linenos">22</span>
<span class="hll"><span class="linenos">23</span><span class="n">bec</span><span class="o">.</span><span class="n">propagate</span><span class="p">(</span><span class="mf">10e-3</span><span class="p">,</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="p">[</span><span class="n">cavity</span><span class="p">,</span> <span class="n">trap</span><span class="p">,</span> <span class="n">contact</span><span class="p">],</span> <span class="p">[</span><span class="n">animation</span><span class="p">])</span>
</span></pre></div>
</div>
<p>The <a class="reference internal" href="../api/callbacks.html#torchgpe.bec2D.callbacks.Animation" title="torchgpe.bec2D.callbacks.Animation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Animation</span></code></a> callback temporarily stores all the data to be plotted, to generate and join together the images at the end of the propagation. Note that generating the images can be a lengthy process, but it can be parallelized over different cores. In the figure below we show the evolution of the cloud’s density throughout time, together with the cavity field and the pump strength in the bottom panel. We see that when the pump strength is approximately <span class="math notranslate nohighlight">\(5\)</span> recoil energies, the bec undergoes a phase transition and the cavity field abruptly increases.</p>
<a class="reference internal image-reference" href="../_images/quickstart_self_organisation.gif"><img alt="Real time animation" class="align-center" src="../_images/quickstart_self_organisation.gif" style="width: 300px;" />
</a>
<p>This quickstart guide has shown how to set up and run a simple simulation with TorchGPE. In the next sections we will delve deeper into the package, discussing the different potentials and the runtime parameters that can be set.</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="installation.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Installation</p>
      </div>
    </a>
    <a class="right-next"
       href="fundamentals.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Basic usage</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-bec">Creating a BEC</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#initializing-the-wave-function">Initializing the wave function</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#initializing-the-potentials">Initializing the potentials</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imaginary-time-propagation">Imaginary time propagation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#real-time-propagation">Real time propagation</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, Quantum Optics group @ ETH Zurich.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>